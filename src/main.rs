use std::cmp::Ordering;
// é»˜è®¤ä¼šå°† prelude å¯¼å…¥åˆ°æ¯ä¸ªåŒ…é‡Œé¢ã€‚å¦‚æžœè¦ä½¿ç”¨ä»¥å¤–çš„åº“ä¸­å†…å®¹ï¼Œå°±éœ€è¦ä½¿ç”¨ useå°†åŒ…å¯¼å…¥è¿›æ¥ã€‚
use std::io;
// trait ç›¸å½“äºŽæŽ¥å£ï¼Œé‡Œé¢å®šä¹‰äº†ä¸€äº›æ–¹æ³•ã€‚
use rand::Rng;

fn main() {
    // å¸¦äº†ä¸€ä¸ªï¼ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå®ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚
    println!("Hello, world!");
    // 1ï½ž101ä¹Ÿæ˜¯åŒ…å¤´ä¸åŒ…å°¾
    let secret_number = rand::thread_rng().gen_range(1, 101);
    println!("ç¥žç§˜æ•°å­—: {}", secret_number);
    loop {
        println!("çŒœä¸€ä¸ªæ•°");
        // å¦‚æžœä¸åŠ mutï¼Œåˆ™è¿™ä¸ªå˜é‡ä¸èƒ½è¢«äºŒæ¬¡èµ‹å€¼ã€‚
        // :: è¡¨ç¤ºnewæ˜¯Stringä¸­çš„ä¸€ä¸ªå…³è”å‡½æ•°ï¼Œç±»ä¼¼javaä¸­é™æ€æ–¹æ³•ã€‚
        let mut guess = String::new();
        // è¿™é‡Œä¹Ÿå¯ä»¥å–æ¶ˆä¸Šé¢çš„useï¼Œç„¶åŽè¿™æ ·è°ƒç”¨ï¼š
        // std::io::stdin().read_line ç­‰ç­‰;
        // &è¡¨ç¤ºå¼•ç”¨ï¼Œå¼•ç”¨åœ¨rustä¸­ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥è¦åŠ ä¸Šmut
        // read_line()è¿”å›žç±»åž‹io::Resultï¼Œè¿™ç›¸å½“äºŽä¸€ä¸ªæžšä¸¾ç±»åž‹ï¼Œ
        // è¿™ä¸ªç±»åž‹æœ‰ä¸¤ä¸ªå­—æ®µ OK,Err,expectæ˜¯å¯¹ç»“æžœè¿›è¡Œå¤„ç†ï¼Œå¦‚æžœè¿”å›žæ˜¯Erråˆ™ä¸­æ–­ç¨‹åºå¹¶é€€å‡º
        io::stdin().read_line(&mut guess).expect("æ— æ³•è¯»å–");
        // åœ¨è¿™é‡Œé‡æ–° ä½¿ç”¨guessï¼Œæ˜¯ä¸€ä¸ª shadowçš„æ¦‚å¿µ
        //  let guess: u32 è¿™æ ·çš„å†™æ³•ï¼Œæ˜¾ç¤ºæŒ‡å®šå˜é‡ç±»åž‹ã€‚
        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };

        println!("ä½ çŒœæµ‹çš„æ•°æ˜¯:{}", guess);
        // ç±»ä¼¼switchï¼Œ
        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small"),// è¿™ç§å†™æ³•ï¼Œæ˜¯armæ¦‚å¿µã€‚
            Ordering::Greater => println!("Too big"),//arm
            Ordering::Equal => {
                println!("You win");//arm
                break;
            }
        }
    }
}


fn r_type() {
    // boolç±»åž‹å°±æ˜¯ bool
    // æ•´åž‹ i32 u32 isize usizeç­‰
    // æµ®ç‚¹åž‹ f32 f64
    // å­—ç¬¦ç±»åž‹æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯Unicodeç±»åž‹ï¼Œæ”¯æŒemojiï¼Œæ¯”è¾ƒç‰¹æ®Šã€‚èŒƒå›´ U+0000~U+D7FF , U+E000~U+10FFFF ã€‚
    let a = '2';
    let b = '$';
    let c = 'ðŸ¤”';
}

// tuple å…ƒç»„
fn r_tuple() {
    // å¯ä»¥å°†ä¸åŒç±»åž‹æ•°æ®æ”¾åˆ°ä¸€èµ·
    let s: (i32, f64, u8) = (500, 6.4, 1);
    // èŽ·å–tupå…ƒç´ ï¼Œè®¿é—®tupå…ƒç´ 
    let (x, y, z) = s;
    println!("{} ,{} ,{}", x, y, z);
    // é€šè¿‡.indexèŽ·å–
    println!("{} ,{} ,{}", s.0, s.1, s.2);
}

// æ•°ç»„ï¼Œå°†æ•°æ®æ”¾åœ¨æ ˆä¸Šï¼Œè€Œä¸æ˜¯å †ä¸Š
fn r_array() {
    // è‡ªåŠ¨åˆ¤æ–­ç±»åž‹
    let a = ["1", "2", "3"];
    // å£°æ˜Žç±»åž‹
    let b: [i32; 5] = [1, 2, 3, 4, 5];
    // [3,3,3,3,3]
    let c = [3; 5];
    // è®¿é—®è¶Šç•Œï¼Œè¦æ³¨æ„
    println!(b[12])
}

// åˆ‡ç‰‡
fn r_slice() {
    let a = [1, 2, 3, 4, 5];
    // .. å’Œgoé‡Œé¢çš„: æ€§è´¨ä¸€æ ·.
    let b = a[..3];
    println!("{}".a[4..])
}

// è¯­å¥å’Œè¡¨è¾¾å¼ï¼Œè¯­å¥åŒ…æ‹¬è¡¨è¾¾å¼ï¼Œè¯­å¥è¿”å›žå€¼æ˜¯ç©ºçš„ï¼Œè¡¨è¾¾å¼æœ‰è¿”å›žå€¼{},
// ;æ˜¯å‘Šè¯‰ä¸€ä¸ªè¯­å¥çš„ç»“æŸã€‚
fn r_fn() {
    let condition = true;
    // ifå’Œelseéƒ½æ˜¯è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼æ˜¯æœ‰è¿”å›žå€¼çš„ï¼Œæ‰€ä»¥å¯ä»¥æ”¾åœ¨ç­‰å·çš„å³è¾¹ã€‚
    // è¡¨è¾¾å¼çš„æœ€åŽä¸€ä¸ªå€¼å°±æ˜¯è¡¨è¾¾å¼çš„è¿”å›žå€¼ï¼Œè¿™é‡Œifè¡¨è¾¾å¼è¿”å›žçš„æ˜¯1ã€‚
    let number = if condition { 1 } else { 2 };
    println!("number:{}", number)
}

fn r_for_while_loop() {
    // loop ç›¸å½“äºŽgoé‡Œé¢çš„for {}
    // while å°±æ˜¯ä¼ ç»Ÿçš„é‚£ç§
    let a = [10, 20, 30, 40];
    for e in a.iter() {
        println!("value:{}", e);
    }
    // åŒ…å¤´ä¸åŒ…å°¾ï¼Œç±»ä¼¼python shellç­‰è¯­æ³•
    for number in (1..4).rev() {
        // è¾“å‡º 3 2 1
        print!(number)
    }
}

// å€Ÿç”¨ï¼šå°†å¼•ç”¨ä½œä¸ºå‚æ•°çš„ï¼Œå°±æ˜¯å€Ÿç”¨ï¼Œå¦‚æžœè¦ä¿®æ”¹å€Ÿç”¨çš„æ•°æ®ï¼Œéœ€è¦å£°æ˜Žmutã€‚


// struct
// è°ƒè¯•ä½¿ç”¨ï¼ŒruståŒ…å«è°ƒè¯•åŠŸèƒ½ï¼Œè¿™æ˜¯ä¸ºè¿™ä¸ªç»“æž„ä½“æ˜¾ç¤ºçš„é€‰æ‹©è¿™ä¸€ä¸ªåŠŸèƒ½ã€‚
#[derive(Debug)]
struct User {
    name: String,
    age: u32,
}

// tuple struct
struct Color(i32, u32, i32);

fn r_struct(name: String, age: u32) {
    // å¿…é¡»å…¨éƒ¨èµ‹å€¼ï¼Œä¸èƒ½åƒgoä¸­ï¼Œåªå£°æ˜Žä¸€éƒ¨åˆ†
    let user1 = User {
        // å…¥å‚å­—æ®µå’Œç»“æž„ä½“å­—æ®µä¸€è‡´ï¼Œå¯ä»¥ç›´æŽ¥ç®€å†™ï¼Œç±»ä¼¼nameã€‚
        name,
        age: 32,
    };
    // ..user1 ä½¿ç”¨ user1ä¸­çš„å€¼ï¼Œ
    let user2 = User {
        name: String::from("123"),
        // å…ƒç´ ç›¸åŒå¯ä»¥ä½¿ç”¨ã€‚
        ..user1
    };
    let color = Color(1, 2, 3);
    // è¿™æ ·éœ€è¦å®žçŽ° Display
    // println!("{}", user1);
    // è¿™æ ·éœ€è¦å®žçŽ° Debugï¼Œæˆ–è€…åœ¨ç»“æž„ä½“ä¸ŠåŠ ä¸Š #[derive(Debug)]
    println!("{:?}", user1);
    // æ‰“å°æ›´æ¸…æ™°
    println!("{:#?}", user2);
}

// ç»“æž„ä½“çš„æ–¹æ³•
// å¯ä»¥æœ‰å¤šä¸ª impl User
impl User {
    // èŽ·å–åå­—çš„æ–¹æ³•
    // fn getName(&self) -> String {
    //     // è¿™é‡Œä¹‹æ‰€ä»¥æŠ¥é”™ï¼Œæ˜¯å› ä¸ºrustä¸­ï¼Œæ•°æ®ä¸èƒ½ä»»æ„èµ‹å€¼
    //     // é™¤äº†åŸºæœ¬ç±»åž‹å’Œå®žçŽ°äº†Copyçš„traitçš„ç±»åž‹ã€‚
    //     // Stringåœ¨heapä¸Šï¼Œå¹¶ä¸”æ²¡ä¸»åŠ¨å®žçŽ°copyï¼Œæˆ‘ä»¬è¿”å›žä¸€ä¸ªnameæ—¶å€™ï¼Œå› ä¸ºæ˜¯å€Ÿç”¨ï¼Œä¸èƒ½ç§»äº¤æ‰€æœ‰æƒã€‚
    //     self.name
    // }
    fn getAge(&self) -> u32 {
        self.age
    }
    // å…³è”å‡½æ•°ï¼Œå…³è”å‡½æ•°ä¸ä¼ selfï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡ç»“æž„ä½“è°ƒç”¨
    // è°ƒç”¨æ–¹å¼æœ‰ç‚¹åƒjavaä¸­é™æ€æ–¹æ³•ï¼ŒåŠŸèƒ½ç±»ä¼¼goä¸­NewObjectè¿™ç§ã€‚
    // è°ƒç”¨æ–¹å¼ User::newUser("ä½ å¥½")
    fn newUser(name: String) -> User {
        User {
            name,
            age: 18,
        }
    }
}
